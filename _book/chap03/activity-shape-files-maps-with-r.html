<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5 Activity: Shape files &amp; maps with R | Module 3 Making sense of spatial data</title>
  <meta name="description" content="This is the third module in the FIT5147 Data Exploration and Visualisation unit. In this module you will learn about common graphics for showing spatial data. That is, data that is naturally associated with a geographic location or region and for which you want to explore the data taking this association into account.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5 Activity: Shape files &amp; maps with R | Module 3 Making sense of spatial data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the third module in the FIT5147 Data Exploration and Visualisation unit. In this module you will learn about common graphics for showing spatial data. That is, data that is naturally associated with a geographic location or region and for which you want to explore the data taking this association into account." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Activity: Shape files &amp; maps with R | Module 3 Making sense of spatial data" />
  
  <meta name="twitter:description" content="This is the third module in the FIT5147 Data Exploration and Visualisation unit. In this module you will learn about common graphics for showing spatial data. That is, data that is naturally associated with a geographic location or region and for which you want to explore the data taking this association into account." />
  

<meta name="author" content="Kimbal Marriott">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="activity-maps-data-with-r.html">
<link rel="next" href="activity-leaflet-with-r.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Module 3 Making sense of spatial data</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Making sense of spatial data: Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#aims-of-this-module"><i class="fa fa-check"></i><b>1.1</b> Aims of this module</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-study-for-this-module"><i class="fa fa-check"></i><b>1.2</b> How to study for this module</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html"><i class="fa fa-check"></i><b>2</b> How to design a data map</a><ul>
<li class="chapter" data-level="2.1" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#scale-and-generalisation"><i class="fa fa-check"></i><b>2.1</b> Scale and generalisation</a></li>
<li class="chapter" data-level="2.2" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#coordinate-system"><i class="fa fa-check"></i><b>2.2</b> Coordinate system</a></li>
<li class="chapter" data-level="2.3" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#map-projections"><i class="fa fa-check"></i><b>2.3</b> Map projections</a></li>
<li class="chapter" data-level="2.4" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#choice-of-data-map"><i class="fa fa-check"></i><b>2.4</b> Choice of data map</a><ul>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#choropleth-and-prism"><i class="fa fa-check"></i>Choropleth and prism</a></li>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#dot-density"><i class="fa fa-check"></i>Dot density</a></li>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#proportional-symbol"><i class="fa fa-check"></i>Proportional symbol</a></li>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#contour-isarithmic-three-dimensional-maps"><i class="fa fa-check"></i>Contour (isarithmic) &amp; three-dimensional maps</a></li>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#cartograms"><i class="fa fa-check"></i>Cartograms</a></li>
<li class="chapter" data-level="" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#flow-maps"><i class="fa fa-check"></i>Flow maps</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#choice-of-classes"><i class="fa fa-check"></i><b>2.5</b> Choice of classes</a></li>
<li class="chapter" data-level="2.6" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#aggregation-and-clustering"><i class="fa fa-check"></i><b>2.6</b> Aggregation and clustering</a></li>
<li class="chapter" data-level="2.7" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>2.7</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="2.8" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#multivariate-visualisation"><i class="fa fa-check"></i><b>2.8</b> Multivariate visualisation</a></li>
<li class="chapter" data-level="2.9" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#uncertainty"><i class="fa fa-check"></i><b>2.9</b> Uncertainty</a></li>
<li class="chapter" data-level="2.10" data-path="how-to-design-a-data-map.html"><a href="how-to-design-a-data-map.html#summary"><i class="fa fa-check"></i><b>2.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overview-of-tools-for-creating-data-maps.html"><a href="overview-of-tools-for-creating-data-maps.html"><i class="fa fa-check"></i><b>3</b> Overview of tools for creating data maps</a><ul>
<li class="chapter" data-level="3.1" data-path="overview-of-tools-for-creating-data-maps.html"><a href="overview-of-tools-for-creating-data-maps.html#gis"><i class="fa fa-check"></i><b>3.1</b> GIS</a></li>
<li class="chapter" data-level="3.2" data-path="overview-of-tools-for-creating-data-maps.html"><a href="overview-of-tools-for-creating-data-maps.html#gis-tools-resources"><i class="fa fa-check"></i><b>3.2</b> GIS tools &amp; resources</a></li>
<li class="chapter" data-level="3.3" data-path="overview-of-tools-for-creating-data-maps.html"><a href="overview-of-tools-for-creating-data-maps.html#gis-data-formats"><i class="fa fa-check"></i><b>3.3</b> GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html"><i class="fa fa-check"></i><b>4</b> Activity: Maps &amp; data with R</a><ul>
<li class="chapter" data-level="4.1" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#spatial-visualization-with-r-aka-maps"><i class="fa fa-check"></i><b>4.1</b> Spatial Visualization with R AKA maps</a><ul>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#location-location-location"><i class="fa fa-check"></i>Location, location, location</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#latitude-longitude"><i class="fa fa-check"></i>Latitude &amp; longitude</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#google-maps"><i class="fa fa-check"></i>Google Maps</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#try-some-projections"><i class="fa fa-check"></i>Try some projections</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#x-marker-on-the-map"><i class="fa fa-check"></i>‘X’ marker on the map</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#label-the-map"><i class="fa fa-check"></i>Label the map</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#data-on-a-map-using-quick-map-plot"><i class="fa fa-check"></i>Data on a map using quick map plot</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#choropleth-map"><i class="fa fa-check"></i>Choropleth Map</a></li>
<li class="chapter" data-level="" data-path="activity-maps-data-with-r.html"><a href="activity-maps-data-with-r.html#flow-map"><i class="fa fa-check"></i>Flow Map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="activity-shape-files-maps-with-r.html"><a href="activity-shape-files-maps-with-r.html"><i class="fa fa-check"></i><b>5</b> Activity: Shape files &amp; maps with R</a><ul>
<li class="chapter" data-level="" data-path="activity-shape-files-maps-with-r.html"><a href="activity-shape-files-maps-with-r.html#shapefiles"><i class="fa fa-check"></i>Shapefiles</a></li>
<li class="chapter" data-level="" data-path="activity-shape-files-maps-with-r.html"><a href="activity-shape-files-maps-with-r.html#lets-do-a-shape-file-on-a-map"><i class="fa fa-check"></i>Let’s do a shape file on a map</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="activity-leaflet-with-r.html"><a href="activity-leaflet-with-r.html"><i class="fa fa-check"></i><b>6</b> Activity: Leaflet with R</a><ul>
<li class="chapter" data-level="6.1" data-path="activity-leaflet-with-r.html"><a href="activity-leaflet-with-r.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="activity-leaflet-with-r.html"><a href="activity-leaflet-with-r.html#marker"><i class="fa fa-check"></i><b>6.2</b> Marker</a></li>
<li class="chapter" data-level="6.3" data-path="activity-leaflet-with-r.html"><a href="activity-leaflet-with-r.html#choropleth-map-1"><i class="fa fa-check"></i><b>6.3</b> Choropleth Map</a></li>
<li class="chapter" data-level="6.4" data-path="activity-leaflet-with-r.html"><a href="activity-leaflet-with-r.html#work-with-shiny"><i class="fa fa-check"></i><b>6.4</b> Work with Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html"><i class="fa fa-check"></i><b>7</b> Activity: Introduction to Mapbox</a><ul>
<li class="chapter" data-level="7.1" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#what-is-mapbox"><i class="fa fa-check"></i><b>7.1</b> What is MapBox?</a></li>
<li class="chapter" data-level="7.2" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#what-do-i-need-to-do"><i class="fa fa-check"></i><b>7.2</b> What do I need to do?</a></li>
<li class="chapter" data-level="7.3" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#how-do-i-sign-up"><i class="fa fa-check"></i><b>7.3</b> How do I sign up?</a></li>
<li class="chapter" data-level="7.4" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#mapbox-studio-intro"><i class="fa fa-check"></i><b>7.4</b> Mapbox Studio Intro</a></li>
<li class="chapter" data-level="7.5" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#exercises"><i class="fa fa-check"></i><b>7.5</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#a-create-a-customized-map"><i class="fa fa-check"></i>5.1a Create a customized map</a></li>
<li class="chapter" data-level="" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#b-create-a-customized-map-using-cartogram"><i class="fa fa-check"></i>5.1b Create a customized map using Cartogram</a></li>
<li class="chapter" data-level="" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#a-work-with-your-data"><i class="fa fa-check"></i>5.2a Work with your data</a></li>
<li class="chapter" data-level="" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#b-add-the-data-points-to-your-custom-map"><i class="fa fa-check"></i>5.2b Add the data points to your custom map</a></li>
<li class="chapter" data-level="" data-path="activity-introduction-to-mapbox.html"><a href="activity-introduction-to-mapbox.html#c-make-your-pointers-interactive"><i class="fa fa-check"></i>5.2c Make your pointers interactive</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module 3 Making sense of spatial data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="activity-shape-files-maps-with-r" class="section level1">
<h1><span class="header-section-number">5</span> Activity: Shape files &amp; maps with R</h1>
<div id="shapefiles" class="section level3 unnumbered">
<h3>Shapefiles</h3>
<p>A shapefile, sometimes called an ESRI shapefile (aka Environmental Systems Research Institute) is a format for storing the location, shape, and attributes of geographic features. It is stored as a set of related files (about a dozen).</p>
<p>We require a minimum of 3 files:</p>
<ul>
<li>.shp — shape format; the feature geometry itself</li>
<li>.shx — shape index format; a positional index of the feature geometry to allow seeking forwards and backwards quickly</li>
<li>.dbf — attribute format; columnar attributes for each shape, in dBase IV format (how old is that!)</li>
</ul>
<p><a href="https://en.wikipedia.org/wiki/Shapefile" class="uri">https://en.wikipedia.org/wiki/Shapefile</a></p>
<p>The files (.shp, .shx, .dbf) should all have the same prefix (e.g. NZ.shp, NZ.shx, NZ.dbf). We require 3 sets of files in this activity, you can download them from here:</p>
<p><a href="diagrams_datasets/section4/NZL_adm1">NZ</a><br />
<a href="diagrams_datasets/section4/ne_110m_land1">World</a><br />
<a href="diagrams_datasets/section4/ne_10m_parks_and_protected_lands">US parks</a></p>
<p><code>maptools</code> library is one option to load shapefiles in R.</p>
<p>Install the library first.</p>
<p>Load the library.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)</code></pre>
<p>Look carefully at your RStudio console.</p>
<p>There might be an warning:</p>
<p><img src="diagrams_datasets/section4/r-map-02.png" /></p>
<p>So, according to the prompt message, you should run</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gpclibPermit</span>()</code></pre>
<p>If it is still not work, that means you need to install another package.</p>
<p>Remember the other way to install a package?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;gpclib&quot;</span>)
<span class="kw">gpclibPermit</span>()</code></pre>
<p><img src="diagrams_datasets/section4/r-map-05.png" /></p>
<p>Load the library again, and you should be ready to use <code>maptools</code> library.</p>
<p>If there are errors when you try to install the <code>gpclib</code> library (mostly happened on Windows).</p>
<p>You should download the RTools at <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a>.</p>
<p>Install it in <strong><em>a path without any space</em></strong>.</p>
<p>After that, you should be able to install the <code>gpclib</code> library.</p>
<p>Unzip your downloaded NZ shapefile and place the 3 files (NZL_adm0.shp, NZL_adm0.shx and NZL_adm0.dbf) into your <strong>working directory</strong>.</p>
<p>Now everything is ready, do not wait, just plot it:</p>
<pre class="sourceCode r"><code class="sourceCode r">nz &lt;-<span class="st"> </span><span class="kw">readShapeSpatial</span>(<span class="st">&quot;NZL_adm0&quot;</span>)
<span class="kw">plot</span>(nz)</code></pre>
<p>Be patient, takes a bit time.</p>
<p>Also, the plot is a bit…unexpected.</p>
<p><img src="diagrams_datasets/section4/r-map-04.png" /></p>
<p>Any way, move on to the <strong>world</strong>!</p>
<p>Move the 3 files (ne_110m_land.shp, ne_110m_land.shx and ne_110m_land.dbf) to your <strong>working directory</strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r">world &lt;-<span class="st"> </span><span class="kw">readShapeSpatial</span>(<span class="st">&quot;ne_110m_land&quot;</span>)
<span class="kw">plot</span>(world)</code></pre>
<p>Let’s plot it in another way (with ggplot).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
world_shp &lt;-<span class="st"> </span><span class="kw">readShapePoly</span>(<span class="st">&quot;ne_110m_land.shp&quot;</span>)
<span class="kw">ggplot</span>(
  world_shp,
  <span class="kw">aes</span>(
    <span class="dt">x=</span>long,
    <span class="dt">y=</span>lat,
    <span class="dt">group=</span>group
  )
) <span class="op">+</span><span class="st"> </span>
<span class="kw">geom_path</span>()</code></pre>
<p>Head into the detail of <code>world_shp</code>.</p>
<p>You may get confused about the stored structure.</p>
<p>You can use <code>fortify()</code> to transfer it to our familiar tabular format.</p>
<p>Note: this is <strong>not necessary</strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(world_shp)
world_map &lt;-<span class="st"> </span><span class="kw">fortify</span>(world_shp) <span class="co"># convert into a tabular structure</span>
<span class="kw">head</span>(world_ma</code></pre>
<p>And use the tabular format to plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(
  world_map,
  <span class="kw">aes</span>(
    <span class="dt">x=</span>long,
    <span class="dt">y=</span>lat,
    <span class="dt">group=</span>group
  )
) <span class="op">+</span>
<span class="kw">geom_path</span>()</code></pre>
</div>
<div id="lets-do-a-shape-file-on-a-map" class="section level3 unnumbered">
<h3>Let’s do a shape file on a map</h3>
<p>National parks of America on top of the West coast.</p>
<p>From: <a href="http://blog.mollietaylor.com/2013/02/shapefiles-in-r.html" class="uri">http://blog.mollietaylor.com/2013/02/shapefiles-in-r.html</a></p>
<p>First, put the 3 files (ne_10m_parks_and_protected_lands_area.shp,</p>
<p>ne_10m_parks_and_protected_lands_area.shx and</p>
<p>ne_10m_parks_and_protected_lands_area.dbf) into your <strong>working directory</strong>.</p>
<p>and read them.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap) <span class="co"># Load the shapes and transform</span>
<span class="kw">library</span>(maptools)
 
area &lt;-<span class="st"> </span><span class="kw">readShapePoly</span>(<span class="st">&quot;ne_10m_parks_and_protected_lands_area.shp&quot;</span>)
area.points &lt;-<span class="st"> </span><span class="kw">fortify</span>(area) <span class="co"># transform</span></code></pre>
<p>Now let’s have a look at how the parks distribute.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add some colour</span>
<span class="kw">library</span>(RColorBrewer)
colors &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;BuGn&quot;</span>)
 
<span class="co"># Get the underlying map, it may take a while to get (from google), patience...</span>
mapImage &lt;-<span class="st"> </span><span class="kw">get_map</span>(
  <span class="dt">location =</span> <span class="kw">c</span>(<span class="dt">lon=</span><span class="op">-</span><span class="dv">118</span>,<span class="dt">lat =</span><span class="fl">37.5</span>),
  <span class="dt">color =</span> <span class="st">&quot;color&quot;</span>,
  <span class="dt">source=</span><span class="st">&quot;google&quot;</span>,
  <span class="dt">maptype =</span> <span class="st">&quot;terrain&quot;</span>,
  <span class="dt">zoom =</span><span class="dv">6</span>
)
 
<span class="co"># Put the shapes on top of the map</span>
<span class="kw">ggmap</span>(mapImage) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(
    <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group),
    <span class="dt">data =</span> area.points,
    <span class="dt">color =</span> colors[<span class="dv">9</span>],
    <span class="dt">fill =</span> colors[<span class="dv">6</span>],
    <span class="dt">alpha =</span><span class="fl">0.5</span>
  ) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Longitude&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Latitude&quot;</span>)</code></pre>
<p>Step by step.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the base map</span>
<span class="kw">plot</span>(mapImage)</code></pre>
<p>Then the parks without the base map.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># And the parks without the map...</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>()
<span class="co"># a blank</span>
p <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(
    <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group),
    <span class="dt">data=</span>area.points,
    <span class="dt">color=</span>colors[<span class="dv">9</span>],
    <span class="dt">fill=</span>colors[<span class="dv">6</span>],
    <span class="dt">alpha =</span><span class="fl">0.5</span>
  )<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Longitude&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Latitude&quot;</span>)</code></pre>
<p>And we can stack them layer by layer.</p>
<p><br><br></p>
<p>We still forget something.</p>
<p>Remember the unexpected NZ at the beginning?</p>
<p><strong>Why does a huge shape file result in such a small plot (NZ)?</strong></p>
<p>(one theory is that there are lots of little islands, another is that there are too many sheep)</p>
<p><strong>Don’t forget to restore NZ to it’s former glory</strong></p>
<pre class="sourceCode r"><code class="sourceCode r">nz &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;nz&quot;</span>)
<span class="co">#Prepare a map of NZ</span>
nzmap &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nz, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span>
<span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;gold&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;gold&quot;</span>)
<span class="co"># Plot it in cartesian coordinates</span>
<span class="co"># nzmap</span>
<span class="co"># With correct mercator projection</span>
nzmap <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>()
<span class="co"># With the aspect ratio approximation</span>
<span class="co"># nzmap + coord_quickmap()</span></code></pre>
<p><strong>What formats are these built-in maps, e.g. map_data(“nz”), is it a .shp?</strong></p>
<p><strong>How old is this ESRI format?</strong><br />
<strong>What are some more recent alternatives?</strong><br />
<strong>Can you open just the .shp files (and view shapes) – in R? Some other way?</strong></p>
<hr />

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="activity-maps-data-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="activity-leaflet-with-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "Module"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
